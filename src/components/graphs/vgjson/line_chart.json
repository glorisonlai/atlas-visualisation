{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": 1000,
  "title": "Yearly Temperature Fluctuation",
  "data": {
    "format": { "type": "csv" },
    "url": "atlas-visualisation/Environment_Temperature_change_E_All_Data_Cleaned.csv"
  },
  "transform": [
    { "filter": { "field": "Area", "equal": "World" } },
    { "filter": { "field": "Months Code", "equal": "7020" } },
    {
      "fold": [
        "Y1961",
        "Y1962",
        "Y1963",
        "Y1964",
        "Y1965",
        "Y1966",
        "Y1967",
        "Y1968",
        "Y1969",
        "Y1970",
        "Y1971",
        "Y1972",
        "Y1973",
        "Y1974",
        "Y1975",
        "Y1976",
        "Y1977",
        "Y1978",
        "Y1979",
        "Y1980",
        "Y1981",
        "Y1982",
        "Y1983",
        "Y1984",
        "Y1985",
        "Y1986",
        "Y1987",
        "Y1988",
        "Y1989",
        "Y1990",
        "Y1991",
        "Y1992",
        "Y1993",
        "Y1994",
        "Y1995",
        "Y1996",
        "Y1997",
        "Y1998",
        "Y1999",
        "Y2000",
        "Y2001",
        "Y2002",
        "Y2003",
        "Y2004",
        "Y2005",
        "Y2006",
        "Y2007",
        "Y2008",
        "Y2009",
        "Y2010",
        "Y2011",
        "Y2012",
        "Y2013",
        "Y2014",
        "Y2015",
        "Y2016",
        "Y2017",
        "Y2018",
        "Y2019"
      ],
      "as": ["Year", "Change"]
    },
    {
      "pivot": "Element Code",
      "groupby": ["Year"],
      "value": "Change"
    },
    {
      "calculate": "datum['7271'] - datum['6078']",
      "as": "tempLo"
    },
    {
      "calculate": "datum['7271'] + datum['6078']",
      "as": "tempHi"
    }
  ],
  "encoding": {
    "x": { "field": "Year", "type": "nominal" }
  },
  "layer": [
    {
      "mark": { "type": "area", "opacity": 0.3, "color": "#85C5A6" },
      "encoding": {
        "y": { "field": "tempHi", "type": "quantitative" },
        "y2": { "field": "tempLo", "type": "quantitative" }
      }
    },
    {
      "mark": { "type": "line" },
      "encoding": {
        "y": {
          "field": "7271",
          "type": "quantitative"
        }
      }
    }
  ]
}
